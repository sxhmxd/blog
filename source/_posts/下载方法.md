---
title: 下载方法

---
### 一 返回文件流下载
 

 ```javascript
 
// 通用下载方法
export function download(url, params, filename, config) {
  downloadLoadingInstance = ElLoading.service({
    text: '正在下载数据，请稍候',
    background: 'rgba(0, 0, 0, 0.7)',
  })
  return service
    .post(baseURL + url, params, {
      transformRequest: [
        (params) => {
          return tansParams(params)
        },
      ],
      headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
      responseType: 'blob',
      ...config,
    })
    .then(async (data) => {
      const isLogin = await blobValidate(data)
      if (isLogin) {
        const blob = new Blob([data])
        saveAs(blob, filename)
      } else {
        const resText = await data.text()
        const rspObj = JSON.parse(resText)
        const errMsg = errorCode[rspObj.code] || rspObj.msg || errorCode['default']
        ElMessage.error(errMsg)
      }
      downloadLoadingInstance.close()
    })
    .catch((r) => {
      console.error(r)
      ElMessage.error('下载文件出现错误，请联系管理员！')
      downloadLoadingInstance.close()
    })
}
 ```

### 二 链接下载

```javascript

const baseURL =
  import.meta.env.VITE_APP_SERVER_ID == 1
    ? window.$BaseUrl.BASE_API
    : import.meta.env.VITE_APP_BASE_API
export function dowanLoadUrls(urls: Array<string>) {
  urls.forEach((item) => {
    if (item) {
      const iframe = document.createElement('iframe')

      iframe.style.display = 'none'
      iframe.src = baseURL + item
      document.body.appendChild(iframe)
      // elink.click()
      setTimeout(() => {
        iframe.remove()
      }, 50 * 1000)
    }
  })
}

//  xml 或者txt 的下载用上面的方法下载在浏览器里是预览
// 需要增加 增加头部信息
export function downLoadXM(url) {
  const name = url.split('/')
  const createUrl = baseURL + url
  fetch(createUrl, {
    method: 'GET',
    headers: new Headers({
      'Content-Disposition': 'attachment',
    }),
  })
    .then((res) => res.blob())
    .then((data) => {
      const blobUrl = window.URL.createObjectURL(data)
      download(blobUrl, name[name.length - 1])
    })
}

function download(blobUrl, name) {
  const a = document.createElement('a')
  a.download = name
  a.href = blobUrl
  a.click()
   setTimeout(function() {
    documet.body.removeChild(a);
  }, 1000);
}
```