---
title: TCP
date: 2021-07-06 10:47:04
tags:
---

## TCP

  只要我们知道另一位伙伴B 的 IP 地址，且之间的网络是通的，无论多远，你都可以将一个数据包发送给另外一个人
  ![](02.png)
    `这是 物理层、数据链路层、网络层这三层所做的事情。`
  站在第四层，可以利用下三层所做的铺垫，可以随心所欲的发送数据。这层是 `传输层`
  ![](01.gif)
  
  前三层协议只能把数据包从一个主机搬到另外一台主机，但是到了目的地以后，数据包具体交给哪个`程序`(进程)
  ![](03.png)
  因此需要将通信进程区分开来，于是就给每一个进程分配一个数字编号即 `端口号`。
  ![](04.jpg)

  发送的数据包上，增加了传输层的头部，`源端口号与目标端口号`
  ![](05.png)
  
  这样原本是主机与主机的通信，升级为了`进程和进程之间的通信`，
  使用 UDP 协议无忧无虑地同 B 进行通信，一直没有问题，但是由于网络不可靠，数据包可能在半路丢失，而 A 和 B 却无法察觉。
  ![](06.gif)
  对于丢包，只要解决两个事
    - A 怎么知道包丢了 (让 B 告诉 A)
    - 丢了包怎么办 (重传)
  因此设计了如下方案： A 每发送一个包，都必须收到来自B 的确认(ACK),再发下一个，否则在一定时间内没有收到确认，就`重传`这个包,这个方案叫 `停止等待协议` 。按照这个方法虽然A 无法保证B y一定能收到包 但A 一定能够确认B 是否收到了包，收不到就重试，尽最大努力让这个通信过程变得可靠。
  ![](02.gif)
  
  但是等待虽然能解决问题，但是效率太低了
